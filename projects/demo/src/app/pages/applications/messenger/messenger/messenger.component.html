<section class="flex flex-col gap-4">
  <div class="flex justify-between">
    <h2 class="text-3xl">Messages</h2>
    <div class="border rounded-full w-max">
      <button mat-icon-button>
        <mat-icon>more_horiz</mat-icon>
      </button>
    </div>
  </div>
  <div class="grow bg-surface-container-low flex flex-col rounded-3xl p-4">
    <div class="flex flex-none items-center border-b pb-3.5 gap-2">
      <div class="relative grow">
        <mat-icon class="absolute start-2.5 top-1/2 -translate-y-1/2">search</mat-icon>
        <input type="text" matInput placeholder="Search"
               class="bg-surface-container-low w-full border outline-none ps-10 h-10 pe-3 focus-visible:border-primary rounded-full">
      </div>
      <button mat-icon-button>
        <mat-icon>tune</mat-icon>
      </button>
    </div>
    <div class="grow relative">
      <div class="py-4 absolute inset-0 space-y-3">
        @for (thread of threads; track thread) {
          <div class="border relative rounded-2xl p-2 cursor-pointer hover:bg-surface-bright [&.selected]:bg-surface-bright group"
               [class.selected]="isThreadSelected(thread)" (click)="selectThread(thread)">
            @if (thread.unreadMessagesCount > 0) {
              <div class="size-5 text-xs bg-red-500 text-white font-medium inline-flex items-center
                        justify-center absolute end-2 top-2 rounded-full flex-none">{{ thread.unreadMessagesCount }}</div>
            }
            <div class="flex items-center gap-3">
              <emr-dicebear class="size-11" [key]="thread.sender.id" [src]="thread.sender.avatarUrl"/>
              <div class="min-w-0">
                <div class="font-bold whitespace-nowrap text-ellipsis overflow-hidden">{{ thread.sender.name }}</div>
                <time class="text-xs text-neutral-600">{{ thread.createdAt | date }}</time>
              </div>
            </div>
            <div class="flex mt-2">
              <div class="min-w-0">
                <div class="text-tiny whitespace-nowrap text-ellipsis overflow-hidden">
                  {{ thread.title }}
                </div>
                <div class="text-tiny whitespace-nowrap text-ellipsis mt-0.5 overflow-hidden text-neutral-500">
                  You: {{ thread.lastMessage }}
                </div>
              </div>
              <div class="hidden group-hover:block">
                <button mat-icon-button>
                  <mat-icon>star</mat-icon>
                </button>
              </div>
            </div>
          </div>
        }
      </div>
    </div>
  </div>
</section>
<main class="flex flex-col">
  <div class="max-w-full min-w-0 pb-4 flex justify-between border-b gap-4">
    <div class="overflow-hidden min-w-0 w-[400px]">
      <div class="font-bold min-w-0 text-2xl whitespace-nowrap text-ellipsis overflow-hidden">{{ selectedThread.sender.name }}</div>
      <div class="text-neutral-600 min-w-0 text-sm mt-1 whitespace-nowrap text-ellipsis overflow-hidden max-w-full">
        {{ selectedThread.title }}
      </div>
    </div>
    <div class="flex gap-3 flex-start">
      <div class="border rounded-full w-max h-max">
        <button mat-icon-button>
          <mat-icon>videocam</mat-icon>
        </button>
      </div>
      <div class="border rounded-full w-max h-max">
        <button mat-icon-button>
          <mat-icon>calendar_clock</mat-icon>
        </button>
      </div>
      <div class="border rounded-full w-max h-max [&.sidebar-active]:border-on-surface"
           [class.sidebar-active]="sidebarActive" (click)="toggleSidebar()">
        <button mat-icon-button>
          <mat-icon>dock_to_left</mat-icon>
        </button>
      </div>
    </div>
  </div>
  <div class="grow">
    ssss
  </div>
  <div>
    <div class="border shadow-sm rounded-2xl p-4">
      asfasfaf
    </div>
  </div>
</main>
@if (sidebarActive) {
  <aside class="sidebar">
    <div class="h-full rounded-3xl bg-surface-container-low p-5 relative">
      <div class="rounded-full w-max absolute end-2 top-2">
        <button mat-icon-button (click)="toggleSidebar()">
          <mat-icon>close</mat-icon>
        </button>
      </div>


    </div>
  </aside>
}
